import os
import numpy as np
import numpy.ma as npma
from osgeo import gdal,osr,ogr


outletfac = [-8.3101627424626372, -1.9992604091994144, -1.53710947194809, -2.1368401584178978, -3.6655271204222717, -6.2371059007165419, -32.316693061537855, -5.1924115028169577, -49.478312504574049, -5.3512205127334349, -10.740074499844393, -6.6551168589289498, -8.961427863137331, -4.1650095693215698, -3.6256624745728185, -3.511010546158893, -1.7688081927557147, -1.3281335408672785, -2.9975886939551177, -1.1516860047599387, -1.9652217914457459, -4.2468709876193351, -10.139693083023534, -15.872570268621425, -4.1622052104598835, -3.6644081963011983, -3.3778909885069495, -2.6725836236490528, -9.055942143687199, -2.0788553601028017, -1.8082392952794781, -8.0859015658752273, -6.2508270181329237, -4.708365219300747, -9.6737497357635664, -4.11152508023625, -2.3024102268066771, -2.8843268089346412, -10.534348567530378, -6.9603816290068901, -3.8933060362738727, -5.6345441689747435, -1.4144275761873299, -7.5385352486552861, -25.920363951726543, -5.0935782209170668, -2.8649786144770473, -1.4293345739562684, -9.8825766956257848, -13.893798727389205, -15.893831215648614, -1.3972575272941603, -1.9708654979357478, -7.4582924568993185, -3.0405187560993361, -3.5381703426176281, -3.2595797827307158, -4.2962922996890862, -2.0139029463107487, -7.2203437921565561, -5.5588363394581481, -2.1955763037540161, -1.8583596250412473, -5.0188799607088743, -3.771598632375162, -1.9939435678611304, -1.8817949425988338, -2.5081925622342864, -9.9733965149722117, -2.9869711877616094, -3.8029964272450956, -3.3316001634075421, -5.3213098142907613, -40.511305444182767, -3.332525627226786, -1.8842697735604756, -2.5788714842229408, -5.3272134697430404, -6.2309965393541056, -3.8020650273860856, -3.5766253368376852, -407.87474637229985, -1.4774397515260353, -5.2766821814469314, -12.176335599187437, -4.4379406519857074, -4.2889142626711374, -3.4629965487816952, -3.1869374655540392, -5.5506015352097666, -2.3112283284976329, -2.0884459483854738, -12.725039828654495, -1.7823432466728601, -371.9802402144503, -30.636191162617507, -55.564967941660861, -4.0960075852855384, -72.045775487675428, -1.5617918043348991, -1.6422123586149731, -7.3778931791931877, -1.9663723586503452, -4.6312744938525512, -1.0998420230650821, -2.5939805183060707, -1.7423147904550966, -2.6124855322693561, -2.5110701511114457, -3.0955409083996899, -2.5580965800410036, -3.6870055850658368, -4.3577342610398988, -10.805373891987811, -5.6728682267044315, -1.7731917886879203, -1.207374257061206, -1.420981450020617, -6.4393774889669615, -3.6907953712670363, -6.4735171167902958, -3.5376268354251681, -3.7964965089694465, -4.6327540935072777, -2.1224279134479729, -4.0447684622996851, -2.1904576468788668, -6.090818210282495, -2.625771453710128, -5.008129057915208, -3.9851537473888001, -2.5108094365956761, -4.6584446361181788, -2.7515007364083166, -2.9716711539872982, -1.1250866946994582, -2.2022049684152649, -5.9242710510024867, -5.7372667504693702, -4.8069736223729302, -4.3211700278003615, -3.9473877261846742, -6.1755048195458331, -2.3094130619817816, -1.5385594735495924, -1.4739695453227302, -8.1187074387384133, -2.8643946475794104, -1.4650594083862845, -1.0759073959402847, -2.2230862067522779, -3.7362236090216845, -1.7028952627427874, -1.7950286847377743, -8.9459062866545977, -1.8180249081323907, -7.2273371929170223, -1.6690407984546856, -2.4221481615506755, -1.8097254995766547, -1.8582902395960117, -2.4879621191924048, -1.9087639058815558, -1.4831157266956252, -1.9874087247923178, -1.4505737388809112, -3.2394344862040745, -1.5756219501576205, -3.4725152260315499, -1.4056347189240834, -1.4273056335450549, -4.9167438838194055, -7.9666025672153182, -3.3083898793274242, -2.8251027912522706, -3.7416972666899162, -4.0828947304824119, -1.950183089152447, -7.7394861334017406, -2.8164623803932272, -3.4896911235348997, -4.2223946749243755, -3.807053608551898, -2.7778539302416805, -3.3343548301897492, -4.6475201190651241, -10.322305428274024, -9.1925209804997277, -3.0150117974232287, -2.0404812548016844, -4.1191410539941709, -8.7516795289046296, -5.6319351382413858, -2.0174777759236191, -1.0167843797952696, -1.9982009365864646, -5.1106098722685589, -1.8798419130039659, -1.0013185731501499, -7.3882030549304982, -1.9106857558614425, -9.374228228209363, -6.4253374672350629, -2.5672042715302328, -2.8704359130442354, -15.35059993930029, -2.8687747078221313, -4.9102871636698184, -1.9554365397782127, -2.8452115958792219, -1.1965978513177278, -1.6935352562010275, -1.3098666758234985, -2.819259034174729, -1.1738767260386258, -1.604854832355485, -4.3859844825389587, -2.8785417191276443, -1.9873057581181535, -2.4420850225597879, -5.0347139769063691, -3.1826507357312823, -1.5489159875087501, -1.7597888398866159, -1.7505224454078505, -7.3160052469275367, -6.404099128134721, -3.8818591194254615, -9.2077425421739036, -6.6932275146275169, -3.549613916499565, -1.6190894640208231, -4.2871419713795103, -2.5312914584222241, -1.9768864449014594, -3.7693001466633245, -5.1004373296069936, -3.0943241311769376, -3.2647562546146309, -2.4731722435683183, -1.7549404595666396, -4.8106980720271286, -3.0182972888059507, -8.4512241170999882, -3.218683466146937, -2.2038414906289456, -1.8206341341736856, -2.9572953275776408, -3.466987263646097, -4.5786112727650732, -1.0685055177934415, -2.5013591852183508, -2.9980054044877398, -2.6272616789944414, -4.163271960688812, -5.0014405279631839, -12.992008812222148, -7.2994909442349742, -5.3023678908504328, -2.2609288820467253, -5.7397600044307184, -5.5481133080403859, -5.61039640645975, -4.9278104991858402, -1.7228265649829118, -2.2290595470382835, -1.3268536952761272, -3.7150563191029962, -3.6956863186460618, -2.3417640215914211, -4.3409288885436128, -9.0813065317936772, -7.6188183895118193, -3.8748065944664396, -2.4354514192330403, -1.6185389135705259, -1.0991596293657684, -1.9485070679313983, -3.7264829854418013, -4.9813980364697263, -5.6701506926414265, -3.5377977624020662, -3.5788927673248789, -1.2820578598105519, -11.249434317702752, -5.7701495405815715, -5.4357851981272987, -6.215042295987999, -5.7493859506823837, -10.867944381966142, -10.887797266008214, -19.234909523652561, -5.7156573900525336, -2.2209619239695626, -6.3698872317414335, -1.5019903424368175, -3.1731949847726373, -8.8398312770908944, -4.0043139532727361, -4.6400388756155238, -3.1306500656148932, -4.0331061114953926, -8.6303074102519481, -3.346586023513729, -8.0023328824742794, -6.3562645048895003, -5.4029128374934103, -8.5516309055865314, -4.6661023454956192, -7.4844063487483874, -7.4303838742089701, -10.985311295291581, -8.5463773290469245, -8.4873602418036427, -8.6159297706806264, -7.9770377926313936, -7.4681559516172982, -5.5826954463998719, -5.4198879798069681, -6.7940010646636173, -5.259957488461005, -7.2458910355345871, -3.9846781838746441, -4.1157335626696154, -6.0811138844702777, -4.390532919045719, -7.8830275142248247, -9.8583488410923419, -6.3534415376836755, -5.6375631480825508, -5.2728627371199188, -4.1563304163975481, -6.4561111464352052, -2.5883495433865811, -1.9336827203589564, -1.816167859064074, -2.818265582967419, -2.228162688381786, -4.2236754398922924, -3.0773750570652529, -2.259251349932351, -2.7092353698751479, -2.4187622081868101, -2.2650853695108677, -1.8821313481083228, -2.4379788877130713, -2.715861403665309, -5.3302653123562802, -3.147754418600218, -1.5604815199278779, -2.5019284592112667, -1.2010150756425821, -1.6607696445497826, -2.89392417677904, -2.3592445391742451, -2.811589635980019, -3.5465832397720267, -9.1194514307960546, -4.8571052306925271, -4.3671349004943023, -3.1151307413492781, -1.9703323103416557, -7.8327827537480736, -1.2419259410964634, -12.86820328785088, -1.2089701079733293, -8.9782689424291036, -2.1077263216398041, -1.6527828023519189, -4.9598095392426256, -6.6116784900474936, -1.5150713006549428, -28.607463826258723, -47.357984062818247, -9.1782703833470354, -92.361423924128957, -2.3581467413317561, -3.2391020566715025, -9.6255523415053972, -3.21571631755151, -2.7193663643438239, -9.0667070395264755, -10.577749054952632, -4.3635212877272336, -2.7549499577905792, -2.3977120265745948, -5.038686701659099, -8.1832306428570476, -10.659893461754354, -6.0834290919431186, -3.6628343273254638, -7.9086026159499951, -13.938802318267136, -3.6654104848205922, -4.5952015136291875, -8.7198560932626652, -5.0159690729511821, -100.81932381877213, -27.446157879423506, -2.9776257766095893, -3.7449433195601256, -5.4015514064627217, -1.35310277152042, -2.390853239642603, -4.0385568429188066, -4.7187224155189238, -5.7203968341035161, -4.0678897086857475, -4.1019984215499381, -3.0753577926597382, -2.0044633208689882, -1.0008172435837133, -1.0457254840140129, -1.0000654730461671, -1.000000000000022, -4.4077465659511006, -2.6323788475138188, -1.1446630362934103, -1.6199453487344508, -1.8482017201062877, -1.9754027281227797, -1.9539194929082246, -2.2210356105837699, -2.6810223896074925, -2.9073834266850924, -3.3131026959075101, -4.629579614879507, -3.4507700729687256, -1.5186590940441018, -1.7928957284067641, -2.4375909494919497, -2.6826034576938991, -2.7794551606672657, -1.6869439411343305, -2.0734051910241278, -2.6426447761768799, -2.9697037087956235, -3.3285709972195736, -4.4603951200668126, -3.8387623586880748, -4.7367612575465641, -4.9876352599173988, -5.5836661574741191, -4.7394115567790438, -4.1463788341626016, -4.6406659972939019, -3.8023058796892157, -3.6876294688855977, -5.414168507201059, -5.7263359230799873, -6.0132293843443181, -5.7415187949984121, -7.3137392450729592, -6.4720601936518545, -5.7040896489222419, -5.3903468629921782, -2.6616109759414566, -1.1737369877564716, -1.0288272644822019, -1.3572608948574187, -2.309936130693274, -1.8694450068377524, -4.8488663318102994, -3.1559022465385529, -5.6337701885567961, -2.3496379002341574, -2.529758890706594, -3.2873973769509122, -4.5339155229759669, -5.3501973829244163, -5.0462785966457551, -3.3920509585663319, -3.0570860136889504, -5.0669588068762232, -7.2065275195786533, -10.907916974208435, -9.5315315583083624, -7.9638292884991424, -4.2174770716965755, -3.954917418684702, -3.3315155844744151, -3.706542906302011, -3.9726258107099097, -4.0046193308150198, -1.1620556942196383, -4.0789112262792946, -1.99003113608507, -5.3666579658355165, -1.0000161698939753, -6.1687566355876644, -1.0517772116384931, -1.8669064130577797, -4.2097086979959997, -1.711878555112418, -1.8671839015241596, -1.0021872107614715, -1.0351784329785327, -1.0221701611874612, -7.5542767805135931, -8.4831257111672915, -11.405605657118045, -19.733826556235176, -6.734554511948577, -3.0129173244117609, -4.7228309533840216, -4.5107010298287609, -8.3364189098678079, -5.3535656469554578, -8.4259594025121665, -7.7970406688746499, -5.4599043325131635, -6.3899294483382665, -5.6286395734623706, -4.8191142637414313, -2.0267516515373156, -1.9738396676310903, -2.4400351579952444, -1908.7988322791389, -1.0013444056087413, -2.4284613038651202, -1.1561635542151822, -1.3594473617984084, -1.6142330504398579, -2.7636223675041478, -2.883065688150813, -3.0108788803865725, -2.5805135161203614, -33.247797960819433, -1.5426034518941616, -1.0015407946069459, -7.6815956735791824, -5.1611337604382355, -5.6331535505619952, -6.9617194659886001, -4.8905284210739346, -5.1935320999814643, -10.460408568261721, -4.5522711337149611, -9.8899865441823369, -2.9568616822713163, -2.6738328278962538, -2.3050431883880491, -6.6296144999292945, -5.0261608713744073, -3.4402335522139529, -2.7562372641324044, -1.997924879130651, -3.1207894548954749, -2.3128275401956673, -2.3655315068091096, -3.5057844958957274, -2.0840223739578461, -1.4296943371613122, -1.3751522708365542, -5.0740274081165371, -1.3127875367289483, -2.1165001176924632, -3.1427036815826086, -12.209628576841229, -1.001239257445407, -1236.5402395535359, -51.979246544403146, -1.7677194505028246, -2.4275455200490774, -1.7423841539060063, -4.6885312182654388, -5.794883973657428, -2.6840480026300684, -16.613252959820063, -2.9426125475018639, -4.6608325158772059, -1.1896164909321154, -7.2848576990354417, -8.4412542003960951, -2.3311272518462491, -1.3736717121391955, -1.5491091414746871, -8.9994175817629003, -3.243039159404177, -1.072902520747266, -2.7656406306824977, -6.024453625401871, -1.9386487198443156, -3.3034394547107966, -1.1089318714118515, -1.5865165471752487, -1.7643253258270806, -2.5955943714229406, -2.9012968638123078, -2.5070789679730483, -2.5580397110002524, -3.0597556139338264, -2.9696742024029694, -3.4086777256501293, -3.8757237146766585, -3.8307962194848897, -4.3048176411939121, -4.6203457857918471, -12.983462753130555, -3.4519336575656525, -781.15442566121976, -1.9994618683804881, -4.4203410324778316, -1.7186263673605551, -3.1103840517150698, -1.0, -2.7374661147945627, -855.92878852611739, -37.619408157698217, -1.018778387991649, -2.1589853695869108, -1.0, -15130647.992524909, -5.0306424765592439, -64.310099269872325]


print outletfac

import matplotlib.pyplot as plt
plt.hist(outletfac, 100)
plt.show()

stop
skeltif = 'C:\\Users\\Harish\\Documents\\GitHub\\pyGeoNet\\data\\'+\
          'skunkroi.tif'
dsskel = gdal.Open(skeltif, gdal.GA_ReadOnly)
aryskel = dsskel.GetRasterBand(1).ReadAsArray()
nanDemArrayskel=np.array(aryskel.T)

gtf =  dsskel.GetGeoTransform()

gtif = gdal.Open( skeltif )

geotransform = dsskel.GetGeoTransform()

a = np.array([[ 12 , 10 , 11,11],
 [944, 944 ,945, 943]])

(upper_left_x, x_size, x_rotation,\
 upper_left_y, y_rotation, y_size) = dsskel.GetGeoTransform()

print (upper_left_x, x_size, x_rotation,\
 upper_left_y, y_rotation, y_size)

x_index = np.array(a[0,:])
print x_index
y_index = np.array(a[1,:])

x_coords = x_index * x_size + upper_left_x + (x_size / 2) +0.01964
y_coords = y_index * y_size + upper_left_y + (y_size / 2) +0.02155

print "Coords: " + str(x_coords) + ", " + str(y_coords)


stop
originX = geotransform[0]
originY = geotransform[3]

print originX,originY

srs = osr.SpatialReference()
srs.ImportFromWkt(dsskel.GetProjection())

srsLatLong = srs.CloneGeogCS()
ct = osr.CoordinateTransformation(srs,srsLatLong)
print ct.TransformPoint(originX,originY)


stop
print 'xlowerCoord %8f' %gtf[0]

daShapefile = r"C:\Mystuff\grassgisdatabase\outletPoints\outletPoints.shp"
driver = ogr.GetDriverByName('ESRI Shapefile')
dataSource = driver.Open(daShapefile, 0)
if dataSource is None:
    print 'Could not open %s' % (daShapefile)
else:
    print 'Opened %s' % (daShapefile)
    layer = dataSource.GetLayer()
    featureCount = layer.GetFeatureCount()
    print "Number of features in %s: %d" \
          % (os.path.basename(daShapefile),featureCount)
    for feature in layer:
        geom = feature.GetGeometryRef()
        print geom.GetX(),geom.GetY()





a = []
a = np.array([[ 12 , 10 , 11,11],
 [944, 944 ,945, 943]])

b = np.array([[12 , 10 , 12, 10],
 [ 945, 943, 943 ,945]])

r1 = a.tolist()[0]
r2 = a.tolist()[1]
r3 = b.tolist()[0]
r4 = b.tolist()[1]


print a
print b

c = np.array([r1+r3,r2+r4])

print c
sizeA = [1423, 944]
lg1 = [a[0,:]>0] and [a[1,:]>0] and\
      [a[0,:] <= sizeA[0]] and [a[1,:] <= sizeA[1]]

print lg1[0]

truefalseArray = np.array([lg1[0],lg1[0]])

print truefalseArray

bf = np.array(a[truefalseArray])

print bf

truefalseArrayMask = np.zeros((truefalseArray.shape))

truefalseArrayMask[truefalseArray==False]=1
print truefalseArrayMask

af = npma.masked_array(a, mask=truefalseArrayMask)

print 'af'
print af

print np.array([bf[0:len(bf)/2],bf[3:len(bf)]])


startpoint = np.array([[12],[23]])
print 'startpoint\n',startpoint

b = np.array([[21],[32]])
startpoint = np.hstack((startpoint,b))

print 'startpoint\n',startpoint

outlet = [   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,   10,   20,   63,   73,
         93,  158,  184,  222,  226,  241,  250,  253,  282,  284,  354,
        382,  483,  503,  513,  571,  600,  731,  731,  810,  859,  875,
        896,  902,  915,  929,  945,  953,  986,  993, 1011, 1014, 1019,
       1025, 1034, 1060, 1122, 1253, 1293, 1315, 1322, 1428, 1428, 1428,
       1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428,
       1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428,
       1428, 1428]
print outlet
outletfloat = [float(x) for x in outlet]

print np.array(outletfloat) * 1.0
print outletfloat
